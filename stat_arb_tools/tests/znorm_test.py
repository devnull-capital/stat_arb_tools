import unittest
from pandas import read_csv
from numpy import delete
from stat_arb_tools import zNorm

actual = [-9.51300994e-01, -1.36012148e+00, -1.63266846e+00, -1.49639497e+00,
2.75160452e-01, -1.76894196e+00, 4.11433946e-01, 1.38886958e-01,
-5.42480512e-01, -2.04148895e+00, -5.42480512e-01, -1.22384798e+00,
1.77416889e+00, 6.83980934e-01, 4.11433946e-01, -6.78754006e-01,
1.09280142e+00, 1.38886958e-01, -1.33660030e-01, 1.36534840e+00,
-1.08757449e+00, 1.50162190e+00, -4.06207018e-01, -1.36012148e+00,
-6.78754006e-01, 1.38886958e-01, -4.06207018e-01, -9.51300994e-01,
2.75160452e-01, -5.42480512e-01, -2.45030943e+00, -2.58658292e+00,
-1.49639497e+00, 2.75160452e-01, -5.42480512e-01, 1.09280142e+00,
-5.42480512e-01, 1.22907491e+00, -1.49639497e+00, -1.49639497e+00,
1.22907491e+00, -8.15027500e-01, 4.11433946e-01, 1.22907491e+00,
-1.08757449e+00, 1.36534840e+00, 6.83980934e-01, 4.11433946e-01,
5.47707440e-01, -4.06207018e-01, 8.20254428e-01, -6.78754006e-01,
-9.51300994e-01, 1.36534840e+00, 2.61346427e-03, 4.11433946e-01,
-4.06207018e-01, -6.78754006e-01, -1.63266846e+00, -9.51300994e-01,
-1.90521545e+00, 4.11433946e-01, -1.08757449e+00, -8.15027500e-01,
1.09280142e+00, 2.75160452e-01, -4.06207018e-01, -1.36012148e+00,
-4.06207018e-01, 4.11433946e-01, 1.38886958e-01, -4.06207018e-01,
-1.49639497e+00, -2.04148895e+00, -1.63266846e+00, 2.61346427e-03,
5.47707440e-01, -1.33660030e-01, -8.15027500e-01, 4.11433946e-01,
5.47707440e-01, 1.38886958e-01, -5.42480512e-01, -1.08757449e+00,
-9.51300994e-01, 1.91044238e+00, -8.15027500e-01, -1.36012148e+00,
1.09280142e+00, -1.33660030e-01, -4.06207018e-01, -1.33660030e-01,
6.83980934e-01, -1.08757449e+00, -8.15027500e-01, -1.22384798e+00,
-9.51300994e-01, -5.42480512e-01, -5.42480512e-01, -1.08757449e+00,
1.50162190e+00, -1.08757449e+00, -1.08757449e+00, -5.42480512e-01,
-9.51300994e-01, -1.36012148e+00, 2.61346427e-03, -1.08757449e+00,
5.47707440e-01, -1.63266846e+00, 5.47707440e-01, 4.11433946e-01,
1.63789539e+00, -1.08757449e+00, -6.78754006e-01, -9.51300994e-01,
-2.69933524e-01, 2.61346427e-03, 2.18298937e+00, 1.22907491e+00,
-1.36012148e+00, -9.51300994e-01, -5.42480512e-01, -1.22384798e+00,
-4.06207018e-01, 6.83980934e-01, -5.42480512e-01, 1.36534840e+00,
-1.63266846e+00, -1.08757449e+00, -2.69933524e-01, -9.51300994e-01,
2.61346427e-03, -1.33660030e-01, 2.61346427e-03, -5.42480512e-01,
-2.45030943e+00, -1.08757449e+00, 1.38886958e-01, -8.15027500e-01,
1.77416889e+00, -1.33660030e-01, 4.11433946e-01, -1.33660030e-01,
-6.78754006e-01, 1.38886958e-01, -4.06207018e-01, -1.22384798e+00,
1.38886958e-01, -2.69933524e-01, -5.42480512e-01, 4.11433946e-01,
5.47707440e-01, -1.08757449e+00, -9.51300994e-01, 8.20254428e-01,
1.22907491e+00, -8.15027500e-01, -1.22384798e+00, 5.47707440e-01,
2.61346427e-03, 8.20254428e-01, -1.08757449e+00, -1.33660030e-01,
-9.51300994e-01, -2.69933524e-01, -1.08757449e+00, -1.63266846e+00,
-8.15027500e-01, -2.69933524e-01, -4.06207018e-01, 4.11433946e-01,
-5.42480512e-01, 6.83980934e-01, -1.22384798e+00, -1.63266846e+00,
2.61346427e-03, 1.38886958e-01, -1.33660030e-01, -1.33660030e-01,
2.31926286e+00, 1.38886958e-01, 4.11433946e-01, -5.42480512e-01,
-6.78754006e-01, 4.11433946e-01, 2.61346427e-03, 2.04671587e+00,
5.47707440e-01, 1.22907491e+00, -1.33660030e-01, 6.83980934e-01,
-2.17776244e+00, -9.51300994e-01, 2.75160452e-01, -1.33660030e-01,
2.61346427e-03, -8.15027500e-01, 4.11433946e-01, 4.11433946e-01,
4.11433946e-01, 6.83980934e-01, -5.42480512e-01, 2.61346427e-03,
-9.51300994e-01, -8.15027500e-01, -4.06207018e-01, 4.11433946e-01,
1.38886958e-01, 6.83980934e-01, -8.15027500e-01, -1.33660030e-01,
1.09280142e+00, -4.06207018e-01, -1.33660030e-01, 5.47707440e-01,
3.00063033e+00, 4.11433946e-01, -1.08757449e+00, -5.42480512e-01,
2.75160452e-01, 8.20254428e-01, 5.47707440e-01, 2.75160452e-01,
-6.78754006e-01, -4.06207018e-01, 2.75160452e-01, 4.11433946e-01,
-1.22384798e+00, 2.75160452e-01, -5.42480512e-01, 5.47707440e-01,
5.47707440e-01, -2.69933524e-01, -4.06207018e-01, 2.75160452e-01,
8.20254428e-01, 1.09280142e+00, -1.33660030e-01, 2.61346427e-03,
1.22907491e+00, -1.33660030e-01, 2.75160452e-01, -5.42480512e-01,
3.54572431e+00, -2.69933524e-01, 2.61346427e-03, 1.22907491e+00,
2.75160452e-01, 4.11433946e-01, -8.15027500e-01, 2.04671587e+00,
2.75160452e-01, 2.61346427e-03, 1.50162190e+00, 2.61346427e-03,
-1.08757449e+00, -2.69933524e-01, 1.91044238e+00, 2.75160452e-01,
1.50162190e+00, 1.77416889e+00, -4.06207018e-01, 2.31926286e+00,
1.77416889e+00, 4.22709178e+00, 1.77416889e+00, 2.75160452e-01,
1.38886958e-01, -2.69933524e-01, 6.83980934e-01, 1.22907491e+00,
1.91044238e+00, 9.56527922e-01, 1.63789539e+00, 1.91044238e+00,
6.83980934e-01, 2.75160452e-01, 1.38886958e-01, 2.61346427e-03,
4.11433946e-01, 1.09280142e+00, 8.20254428e-01, 1.38886958e-01,
-2.69933524e-01, 2.31926286e+00, -1.33660030e-01, 2.61346427e-03,
1.22907491e+00, 9.56527922e-01, 4.11433946e-01, 1.38886958e-01,
2.61346427e-03, -5.42480512e-01, 6.83980934e-01, -5.42480512e-01,
-8.15027500e-01, 2.61346427e-03, -9.51300994e-01, -1.90521545e+00,
2.75160452e-01, -8.15027500e-01, 4.11433946e-01, 5.47707440e-01,
8.20254428e-01, 9.56527922e-01, 1.38886958e-01, 2.61346427e-03,
2.31926286e+00, 4.11433946e-01, 1.36534840e+00, 5.47707440e-01,
2.61346427e-03, -2.69933524e-01, -2.69933524e-01, 4.11433946e-01,
-9.51300994e-01, -9.51300994e-01, -2.69933524e-01, -4.06207018e-01,
-1.22384798e+00, 2.61346427e-03, 6.83980934e-01,  1.22907491e+00,
2.75160452e-01, -2.69933524e-01, 2.04671587e+00, 9.56527922e-01,
4.11433946e-01, 9.56527922e-01, 1.22907491e+00, 5.47707440e-01,
2.75160452e-01, 1.36534840e+00, 4.11433946e-01, -1.36012148e+00,
5.47707440e-01, -1.33660030e-01, -1.08757449e+00, -1.22384798e+00,
-8.15027500e-01, 9.56527922e-01, 1.38886958e-01, 1.38886958e-01,
-1.08757449e+00, -4.06207018e-01, -9.51300994e-01, 1.36534840e+00,
6.83980934e-01, 1.36534840e+00, -4.06207018e-01, -2.69933524e-01,
2.61346427e-03, 2.61346427e-03, 1.50162190e+00, -4.06207018e-01,
-2.69933524e-01, -5.42480512e-01, 2.75160452e-01, -1.08757449e+00,
-6.78754006e-01, 1.36534840e+00, 8.20254428e-01, 1.77416889e+00,
1.09280142e+00]

class TestZNorm(unittest.TestCase):
    def test_female_births(self):
        data = read_csv('stat_arb_tools/tests/test_data/daily-total-female-births.csv', header=0)
        zArr = zNorm(delete(data.values, [0], axis=1).ravel())

        for i in range(len(zArr)):
            self.assertEqual(round(zArr[i], 4), round(actual[i], 4))

if __name__ == '__main__':
    unittest.main()
